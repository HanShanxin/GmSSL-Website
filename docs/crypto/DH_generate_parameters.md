# NAME

DH\_generate\_parameters\_ex, DH\_generate\_parameters,
DH\_check, DH\_check\_params - generate and check Diffie-Hellman
parameters

# SYNOPSIS

    #include <openssl/dh.h>

    int DH_generate_parameters_ex(DH *dh, int prime_len, int generator, BN_GENCB *cb);

    int DH_check(DH *dh, int *codes);
    int DH_check_params(DH *dh, int *codes);

Deprecated:

    #if OPENSSL_API_COMPAT < 0x00908000L
    DH *DH_generate_parameters(int prime_len, int generator,
        void (*callback)(int, int, void *), void *cb_arg);
    #endif

# DESCRIPTION

DH\_generate\_parameters\_ex() generates Diffie-Hellman parameters that can
be shared among a group of users, and stores them in the provided **DH**
structure. The pseudo-random number generator must be
seeded prior to calling DH\_generate\_parameters().

**prime\_len** is the length in bits of the safe prime to be generated.
**generator** is a small number > 1, typically 2 or 5.

A callback function may be used to provide feedback about the progress
of the key generation. If **cb** is not **NULL**, it will be
called as described in [BN\_generate\_prime(3)](http://man.he.net/man3/BN_generate_prime) while a random prime
number is generated, and when a prime has been found, **BN\_GENCB\_call(cb, 3, 0)**
is called. See [BN\_generate\_prime(3)](http://man.he.net/man3/BN_generate_prime) for information on
the BN\_GENCB\_call() function.

DH\_check\_params() confirms that the **p** and **g** are likely enough to
be valid.
This is a lightweight check, if a more thorough check is needed, use
DH\_check().
The value of **\*codes** is updated with any problems found.
If **\*codes** is zero then no problems were found, otherwise the
following bits may be set:

- DH\_CHECK\_P\_NOT\_PRIME

    The parameter **p** has been determined to not being an odd prime.
    Note that the lack of this bit doesn't guarantee that **p** is a
    prime.

- DH\_NOT\_SUITABLE\_GENERATOR

    The generator **g** is not suitable.
    Note that the lack of this bit doesn't guarantee that **g** is
    suitable, unless **p** is known to be a strong prime.

DH\_check() confirms that the Diffie-Hellman parameters **dh** are valid. The
value of **\*codes** is updated with any problems found. If **\*codes** is zero then
no problems were found, otherwise the following bits may be set:

- DH\_CHECK\_P\_NOT\_PRIME

    The parameter **p** is not prime.

- DH\_CHECK\_P\_NOT\_SAFE\_PRIME

    The parameter **p** is not a safe prime and no **q** value is present.

- DH\_UNABLE\_TO\_CHECK\_GENERATOR

    The generator **g** cannot be checked for suitability.

- DH\_NOT\_SUITABLE\_GENERATOR

    The generator **g** is not suitable.

- DH\_CHECK\_Q\_NOT\_PRIME

    The parameter **q** is not prime.

- DH\_CHECK\_INVALID\_Q\_VALUE

    The parameter **q** is invalid.

- DH\_CHECK\_INVALID\_J\_VALUE

    The parameter **j** is invalid.

# RETURN VALUES

DH\_generate\_parameters\_ex(), DH\_check() and DH\_check\_params() return 1
if the check could be performed, 0 otherwise.

DH\_generate\_parameters() (deprecated) returns a pointer to the DH structure, or
NULL if the parameter generation fails.

The error codes can be obtained by [ERR\_get\_error(3)](http://man.he.net/man3/ERR_get_error).

# NOTES

DH\_generate\_parameters\_ex() and DH\_generate\_parameters() may run for several
hours before finding a suitable prime.

The parameters generated by DH\_generate\_parameters\_ex() and DH\_generate\_parameters()
are not to be used in signature schemes.

# SEE ALSO

[DH\_new(3)](http://man.he.net/man3/DH_new), [ERR\_get\_error(3)](http://man.he.net/man3/ERR_get_error), [RAND\_bytes(3)](http://man.he.net/man3/RAND_bytes),
[DH\_free(3)](http://man.he.net/man3/DH_free)

# COPYRIGHT

Copyright 2000-2016 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the OpenSSL license (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
[https://www.openssl.org/source/license.html](https://www.openssl.org/source/license.html).
